package com.wms.abstractclient.module.modules.exploit;

import com.wms.abstractclient.event.PacketSendEvent;
import com.wms.abstractclient.module.Module;
import net.minecraft.client.gui.GuiGameOver;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import org.lwjgl.input.Keyboard;

public class Ghost extends Module {

    private boolean dontDie;

    public Ghost() {
        super("Ghost", Category.EXPLOIT, Keyboard.KEY_NONE);
    }

    @Override
    public void onTick() {
        if(nullcheck()){return;}
        if (mc.currentScreen instanceof GuiGameOver) {
            mc.displayGuiScreen(null);
            mc.player.setHealth(20.0f);
            mc.player.isDead = false;
            mc.player.setPositionAndUpdate(mc.player.posX, mc.player.posY, mc.player.posZ);
            this.dontDie = true;
            sendMsg("Now in a ghost state!");
        }
    }

    @SubscribeEvent
    public void onPacket(PacketSendEvent event){
        if(nullcheck()){return;}
        if(dontDie && event.getPacket() instanceof CPacketPlayer){
            event.setCanceled(true);
        }
    }

    @Override
    public void onDisable() {
        if(nullcheck()){return;}
        if(dontDie){
            mc.player.respawnPlayer();
            dontDie = false;
        }
    }
}
