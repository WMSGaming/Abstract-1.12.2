package com.wms.abstractclient.module.modules.exploit;

import com.wms.abstractclient.event.PacketSendEvent;
import com.wms.abstractclient.module.Module;
import com.wms.abstractclient.setting.Setting;
import net.minecraft.entity.Entity;
import net.minecraft.init.Items;
import net.minecraft.network.play.client.CPacketEntityAction;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraft.network.play.client.CPacketPlayerDigging;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;
import org.lwjgl.input.Keyboard;

public class Bow32k extends Module {

    Setting loop = new Setting(this,"Loops",50,1,150,1);

    public Bow32k() {
        super("Bow32k", Category.EXPLOIT, Keyboard.KEY_NONE);
        addSetting(loop);
    }
    @SubscribeEvent
    public void onPacket(PacketSendEvent event){
        if(event.getPacket() instanceof CPacketPlayerDigging){
            CPacketPlayerDigging packet = (CPacketPlayerDigging) event.getPacket();
            if(packet.getAction() == CPacketPlayerDigging.Action.RELEASE_USE_ITEM){
                if(mc.player.getHeldItemMainhand().getItem() == Items.BOW) {
                    sendVelocityPacket();
                }
            }
        }
    }
    private void sendVelocityPacket(){
        mc.player.connection.sendPacket(new CPacketEntityAction((Entity)mc.player, CPacketEntityAction.Action.START_SPRINTING));
        for(int i = 0; i < loop.getValue();++i){
            mc.player.connection.sendPacket(new CPacketPlayer.Position(mc.player.posX, mc.player.posY - 1.0E-10, mc.player.posZ, true));
            mc.player.connection.sendPacket(new CPacketPlayer.Position(mc.player.posX, mc.player.posY + 1.0E-10, mc.player.posZ, false));
        }
    }
}
